- content_for :breadcrumbs do
  = link_to "Settings", settings_path
  &raquo;
  %b= @setting.name

%table
  %thead
    %tr
      %th{colspan: 2}
        Setting: #{@setting.name}
        - if @setting.editable_by?(current_user)
          = link_to edit_setting_path(@setting) do
            .link-box.action-edit
              = image_tag "icons/pencil.png"
              Edit
          = link_to setting_path(@setting), method: :delete, data: { confirm: 'Are you sure you want to delete this setting?' } do
            .link-box.action-delete x Delete
  %tbody
    - if @setting.parent_settings.present?
      %tr
        %th.centered.sub.width-150= 'Parent Setting'.pluralize(@setting.parent_settings.count)
        %td{class: cycle('even', 'odd')}= @setting.parent_settings.map { |c| link_to(c.name, setting_path(c))}.join(', ').html_safe
    %tr
      %th.centered.sub.width-150 Owner
      %td{class: cycle('even', 'odd'), title: ('This setting is not marked as owned' unless @setting.owned?)}
        = link_to @setting.user do
          - if @setting.owned?
            = @setting.user.username
          - else
            %em= @setting.user.username
    - if @setting.description.present?
      %tr
        %th.centered.sub.width-150.vtop Description
        %td.written-content{class: cycle('even', 'odd')}= sanitize_written_content(@setting.description).html_safe
    - unless @setting.has_items?
      %tr
        %td.centered{class: cycle('even', 'odd'), colspan: 2} — No items yet —
%br

- if @posts.present?
  - reset_cycle
  - content_for :posts_title do
    Posts Tagged: #{@setting.name}

  = render partial: 'posts/list', locals: {posts: @posts}
  %br

- if @characters.present?
  - reset_cycle
  %table
    %thead
      %tr
        %th{colspan: 7} Characters Tagged: #{@setting.name}
    %tbody
      = render partial: 'characters/list_section', locals: {name: nil, characters: @characters.order('name asc'), hide_buttons: true, show_user: true, show_template: true}
  %br

- if @setting.child_settings.present?
  - reset_cycle
  %table
    %thead
      %tr
        %th{colspan: 6} Settings Tagged: #{@setting.name}
    %tbody
      - @setting.child_settings.each do |setting|
        %tr
          %td{class: cycle('even', 'odd')}= link_to setting.name, setting_path(setting)
