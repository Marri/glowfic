%tr
  %th.sub Name
  %th.sub.width-150.centered # of Icons
  %th.sub.width-70 Manage
  %th.sub.width-70 Expand
%tr
  %td.odd.gallery-name
    - if @user.id == current_user.try(:id)
      = link_to '[Galleryless]', gallery_path(id: 0)
    - else
      = link_to '[Galleryless]', user_gallery_path(id: 0, user_id: @user.id)
  %td.width-150.centered.odd.gallery-icon-count= @user.icons.where(has_gallery: false).count
  %td.width-70.odd.gallery-buttons
    - if @user.id == current_user.try(:id)
      = link_to add_gallery_path(id: 0), title: "Add Icons", class: 'gallery-add' do
        = image_tag "/images/add.png"
  %td.centered.width-70.odd
    .gallery-box.vmid{id: "minmax-0", style: 'display: inline-block;', data: {id: 0}}
      .view-button{style: 'padding: 5px 7px;'}= image_tag "/images/bullet_arrow_down.png", class: 'vmid'
%tr
  %td.padding-5.hidden.odd{id: "icons-0", colspan: 4}
    = form_tag delete_multiple_icons_path, method: :delete do
      .gallery{style: 'padding: 0px;'}
      - if @user.id == current_user.try(:id)
        .clear.centered.icons-remove
          = submit_tag "x Delete selected icons permanently", data: { confirm: "Are you sure? These icons will be gone from the site!" }
- @user.galleries.with_icon_count.with_gallery_groups.order('name asc').each do |gallery|
  %tr
    - klass = cycle('even', 'odd')
    %td.gallery-name{class: klass}
      = link_to gallery.name, gallery_path(gallery)
      .tag-box
        - gallery.gallery_groups_data.each do |group|
          = link_to tag_path(group.id), class: 'tag-item-link' do
            %span.tag-item.semiplusopaque
              = group.name
    %td.width-150.centered.gallery-icon-count{class: klass}= gallery.icon_count
    %td.width-70.gallery-buttons{class: klass}
      - if @user.id == current_user.try(:id)
        = link_to add_gallery_path(gallery), title: "Add Icons", class: 'gallery-add' do
          = image_tag "/images/add.png"
        = link_to edit_gallery_path(gallery), title: "Edit Gallery", class: 'gallery-edit' do
          = image_tag "/images/pencil.png"
        = link_to gallery_path(gallery), title: "Delete Gallery", method: :delete, data: { confirm: "Are you sure you want to delete #{gallery.name}?" }, class: 'gallery-delete' do
          = image_tag "/images/cross.png"
    %td.centered.width-70{class: klass}
      .gallery-box.vmid{id: "minmax-#{gallery.id}", style: 'display: inline-block;', data: {id: gallery.id}}
        .view-button{style: 'padding: 5px 7px;'}= image_tag "/images/bullet_arrow_down.png", class: 'vmid'
  %tr
    %td.padding-5.hidden{class: klass, id: "icons-#{gallery.id}", colspan: 4}
      = form_tag delete_multiple_icons_path, method: :delete do
        .gallery{style: 'padding: 0px;'}
        - if @user.id == current_user.try(:id)
          .clear.centered.icons-remove
            = hidden_field_tag :gallery_id, gallery.id
            = submit_tag "- Remove selected icons from gallery", name: 'gallery_delete'
            = submit_tag "x Delete selected icons permanently", data: { confirm: "Are you sure? These icons will be gone from the site!" }
